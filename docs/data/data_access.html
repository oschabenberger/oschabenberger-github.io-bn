<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Foundations of Data Science - 5&nbsp; Data Access</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../data/quality.html" rel="next">
<link href="../data/sources_and_files.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../data/sources_and_files.html">Part II. Data Preparation and Understanding</a></li><li class="breadcrumb-item"><a href="../data/data_access.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Access</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Foundations of Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part I. Data Science and Data Science Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../proj/history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">History and Evolution of Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../proj/lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Data Science Project Lifecycle</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part II. Data Preparation and Understanding</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/sources_and_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Sources and File Formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/data_access.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Access</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Quality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/summarization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Summarization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/sqlbasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">SQL Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data/integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part III. Statistical Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statlearning/general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">General Topics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statlearning/mathstat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Probability and Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statlearning/linalg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statlearning/featproc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Feature and Target Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part IV. Applied Ethics in Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ethics/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ethics/gonewrong.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">How Things Go Wrong</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ethics/bias_harm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Bias and Harm in Algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ethics/privacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Personal Information and Personal Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Part V. Integration of Data Science Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integ/coding_practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Coding Best Practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integ/tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Data Science Tools</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#accessing-local-files" id="toc-accessing-local-files" class="nav-link active" data-scroll-target="#accessing-local-files"><span class="header-section-number">5.1</span> Accessing Local Files</a>
  <ul>
  <li><a href="#csv-files" id="toc-csv-files" class="nav-link" data-scroll-target="#csv-files">CSV files</a></li>
  <li><a href="#json-files" id="toc-json-files" class="nav-link" data-scroll-target="#json-files">JSON files</a></li>
  <li><a href="#parquet-files" id="toc-parquet-files" class="nav-link" data-scroll-target="#parquet-files">Parquet files</a></li>
  <li><a href="#orc-files" id="toc-orc-files" class="nav-link" data-scroll-target="#orc-files">ORC files</a></li>
  </ul></li>
  <li><a href="#working-with-a-database" id="toc-working-with-a-database" class="nav-link" data-scroll-target="#working-with-a-database"><span class="header-section-number">5.2</span> Working with a Database</a>
  <ul>
  <li><a href="#sqlalchemy" id="toc-sqlalchemy" class="nav-link" data-scroll-target="#sqlalchemy">SQLAlchemy</a></li>
  <li><a href="#ibis" id="toc-ibis" class="nav-link" data-scroll-target="#ibis">Ibis</a></li>
  <li><a href="#duckdb" id="toc-duckdb" class="nav-link" data-scroll-target="#duckdb">DuckDB</a>
  <ul class="collapse">
  <li><a href="#reading-files" id="toc-reading-files" class="nav-link" data-scroll-target="#reading-files">Reading files</a></li>
  <li><a href="#connecting-to-the-database" id="toc-connecting-to-the-database" class="nav-link" data-scroll-target="#connecting-to-the-database">Connecting to the database</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cloud-data-resources" id="toc-cloud-data-resources" class="nav-link" data-scroll-target="#cloud-data-resources"><span class="header-section-number">5.3</span> Cloud Data Resources</a>
  <ul>
  <li><a href="#object-storage" id="toc-object-storage" class="nav-link" data-scroll-target="#object-storage">Object storage</a></li>
  <li><a href="#managed-cloud-database" id="toc-managed-cloud-database" class="nav-link" data-scroll-target="#managed-cloud-database">Managed cloud database</a></li>
  <li><a href="#motherduck-serverless-cloud-database" id="toc-motherduck-serverless-cloud-database" class="nav-link" data-scroll-target="#motherduck-serverless-cloud-database">MotherDuck serverless cloud database</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../data/sources_and_files.html">Part II. Data Preparation and Understanding</a></li><li class="breadcrumb-item"><a href="../data/data_access.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Access</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Access</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this section we use Python libraries to access data in the major file formats presented in a previous chapter and convert the files into DataFrames: CSV, JSON, Parquet, and ORC files. The Pandas DataFrame format is common but there are others to consider:</p>
<ul>
<li><p>Polars DataFrames are highly parallelized, support more efficient string handling than Pandas, and allow both lazy and eager execution.</p></li>
<li><p>Arrow tables have highly efficient in-memory columnar format for fast analytics.</p></li>
</ul>
<p>Python has built-in functions for reading data formats, for example, <a href="https://docs.python.org/3/library/csv.html">csv.reader()</a> for CSV files, we use the pandas and Pyarrow packages to read and write files in common formats. Pandas supports an impressive <a href="https://pandas.pydata.org/docs/reference/io.html">list of I/O formats</a> and data sets likely end up as pandas DataFrames anyway, so we might as well convert from file format directly to a DataFrame. The Pyarrow library is becoming increasingly important in data engineering for data science; Pandas uses the Pyarrow engine for several of the important formats, e.g., parquet files. In Pandas 2.0 you can choose whether to use a NumPy-based engine or a Pyarrow-based engine for data manipulation and analysis.</p>
<p>Fortunately, the methods for reading data in Pandas and Polars are very similar, so it is relatively easy to switch from one DataFrame representation to another. For example, the following statements show how to read a CSV file into a Pandas and a Polars DataFrame.</p>
<div id="827a4fd7" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pandas_df <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/iris.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>polars_df <span class="op">=</span> pl.read_csv(<span class="st">"../datasets/iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you start working with DataFrames the syntax can be quite different, however.</p>
<section id="accessing-local-files" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="accessing-local-files"><span class="header-section-number">5.1</span> Accessing Local Files</h2>
<section id="csv-files" class="level3">
<h3 class="anchored" data-anchor-id="csv-files">CSV files</h3>
<p>To convert CSV files to a pandas DataFrame use the pandas <code>read_csv()</code> method. The default behavior is to look for a header line with column names, to interpret commas as field delimiters, to skip blank lines in the file, and to apply utf-8 encoding.</p>
<p>Consider the following file, <code>fitness.csv</code>:</p>
<pre><code>data&gt; head fitness.csv
Age,Weight,Oxygen,RunTime,RestPulse,RunPulse,MaxPulse
44,89.47,44.609,11.37,62,178,182
40,75.07,45.313,10.07,62,185,185
44,85.84,54.297, 8.65,45,156,168
42,68.15,59.571, 8.17,40,166,172
38,89.02,49.874, 9.22,55,178,180</code></pre>
<p>The first line contains comma-separated names for the columns. The following lines contain the data for the attributes, one record per line. To convert the CSV file to a pandas DataFrame use the <code>read_csv()</code> method:</p>
<div id="12b2d1b6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/fitness.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Default result from read_csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span>[np.float64])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Default result from read_csv
   Age  Weight  Oxygen  RunTime  RestPulse  RunPulse  MaxPulse
0   44   89.47  44.609    11.37         62       178       182
1   40   75.07  45.313    10.07         62       185       185
2   44   85.84  54.297     8.65         45       156       168
3   42   68.15  59.571     8.17         40       166       172
4   38   89.02  49.874     9.22         55       178       180</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Oxygen</th>
<th data-quarto-table-cell-role="th">RunTime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>31.000000</td>
<td>31.000000</td>
<td>31.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>77.444516</td>
<td>47.375806</td>
<td>10.586129</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>8.328568</td>
<td>5.327231</td>
<td>1.387414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>59.080000</td>
<td>37.388000</td>
<td>8.170000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>73.200000</td>
<td>44.964500</td>
<td>9.780000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>77.450000</td>
<td>46.774000</td>
<td>10.470000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>82.325000</td>
<td>50.131000</td>
<td>11.270000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>91.630000</td>
<td>60.055000</td>
<td>14.030000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>You can assign your own variable names with the <code>names=</code> option:</p>
<div id="865d642f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/fitness.csv"</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  header<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                  names<span class="op">=</span>[<span class="st">"Age"</span>, <span class="st">"Wgt"</span>,<span class="st">"Oxy"</span>,<span class="st">"RT"</span>,<span class="st">"ReP"</span>,<span class="st">"RuP"</span>,<span class="st">"MP"</span> ])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Wgt</th>
<th data-quarto-table-cell-role="th">Oxy</th>
<th data-quarto-table-cell-role="th">RT</th>
<th data-quarto-table-cell-role="th">ReP</th>
<th data-quarto-table-cell-role="th">RuP</th>
<th data-quarto-table-cell-role="th">MP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>44</td>
<td>89.47</td>
<td>44.609</td>
<td>11.37</td>
<td>62</td>
<td>178</td>
<td>182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>40</td>
<td>75.07</td>
<td>45.313</td>
<td>10.07</td>
<td>62</td>
<td>185</td>
<td>185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>44</td>
<td>85.84</td>
<td>54.297</td>
<td>8.65</td>
<td>45</td>
<td>156</td>
<td>168</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>42</td>
<td>68.15</td>
<td>59.571</td>
<td>8.17</td>
<td>40</td>
<td>166</td>
<td>172</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>38</td>
<td>89.02</td>
<td>49.874</td>
<td>9.22</td>
<td>55</td>
<td>178</td>
<td>180</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>String variables are indicated in the CSV file with quotes:</p>
<pre><code>data&gt;  head herding-cats.csv
"address_full","street","coat","sex","age","weight","fixed","wander_dist","roamer","cat_id"
"15 Fillmer Ave Los Gatos 95030","15 Fillmer Ave","brown","male",5.594,5.016,1,0.115,"yes",1
"244 Harding Ave Los Gatos 95030","244 Harding Ave","tabby","male",6.852,6.314,1,0.129,"yes",2
"16570 Marchmont Dr Los Gatos 95032","16570 Marchmont Dr","maltese","female",4.081, 2.652,0, 0.129,"yes",3
"100 Stonybrook Rd Los Gatos 95032","100 Stonybrook Rd","tabby","female",3.806,3.413,1, 0.107,"yes",4</code></pre>
<div id="ef628557" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cats <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/herding-cats.csv"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   index_col<span class="op">=</span><span class="st">"cat_id"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cats.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              address_full              street     coat  \
cat_id                                                                    
1           15 Fillmer Ave Los Gatos 95030      15 Fillmer Ave    brown   
2          244 Harding Ave Los Gatos 95030     244 Harding Ave    tabby   
3       16570 Marchmont Dr Los Gatos 95032  16570 Marchmont Dr  maltese   
4        100 Stonybrook Rd Los Gatos 95032   100 Stonybrook Rd    tabby   
5           266 Kennedy Rd Los Gatos 95032      266 Kennedy Rd   calico   

           sex    age  weight  fixed  wander_dist roamer  
cat_id                                                    
1         male  5.594   5.016      1        0.115    yes  
2         male  6.852   6.314      1        0.129    yes  
3       female  4.081   2.652      0        0.129    yes  
4       female  3.806   3.413      1        0.107    yes  
5         male  5.164   6.820      1        0.039     no  </code></pre>
</div>
</div>
<p>Pandas is smart about assigning data types to columns, note that string columns are stored as data type <code>object</code>.</p>
<div id="dc18e3de" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cats.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 400 entries, 1 to 400
Data columns (total 9 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   address_full  400 non-null    object 
 1   street        394 non-null    object 
 2   coat          400 non-null    object 
 3   sex           400 non-null    object 
 4   age           400 non-null    float64
 5   weight        400 non-null    float64
 6   fixed         400 non-null    int64  
 7   wander_dist   400 non-null    float64
 8   roamer        400 non-null    object 
dtypes: float64(3), int64(1), object(5)
memory usage: 31.2+ KB</code></pre>
</div>
</div>
<p>You can overwrite the data types by supplying either a default type or a dictionary of types. To change the data type for the <code>fixed</code> column, for example:</p>
<div id="4ee2697f" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cats <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/herding-cats.csv"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                   dtype<span class="op">=</span>{<span class="st">'fixed'</span>:np.float16})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Missing values (see below) can be indicated in CSV files in several ways. The common technique is to leave the entry for the unobserved value empty (no spaces). In the following file the value for <code>appraisal</code> is missing in the third row. The fifth row contains values for <code>land</code> and <code>appraisal</code> only.</p>
<pre><code>data&gt; head landsales2.csv
land, improve, total, sale, appraisal
30000,64831,94831,118500,1.25
30000,50765,80765,93900,1.16
46651,18573,65224,,
45990,91402,137392,184000,1.34
42394,,,168000,
,133351,,169000,
63596,2182,65778,,
56658,153806,210464,255000,1.21</code></pre>
<p><code>read_csv()</code> converts this file correctly to missing values using the NaN (not-a-number) sentinel for the unobserved data:</p>
<div id="34d3a281" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>land <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/landsales2.csv"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>land</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">land</th>
<th data-quarto-table-cell-role="th">improve</th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">sale</th>
<th data-quarto-table-cell-role="th">appraisal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>30000.0</td>
<td>64831.0</td>
<td>94831.0</td>
<td>118500.0</td>
<td>1.25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>30000.0</td>
<td>50765.0</td>
<td>80765.0</td>
<td>93900.0</td>
<td>1.16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>46651.0</td>
<td>18573.0</td>
<td>65224.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>45990.0</td>
<td>91402.0</td>
<td>137392.0</td>
<td>184000.0</td>
<td>1.34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>42394.0</td>
<td>NaN</td>
<td>NaN</td>
<td>168000.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>133351.0</td>
<td>NaN</td>
<td>169000.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>63596.0</td>
<td>2182.0</td>
<td>65778.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>56658.0</td>
<td>153806.0</td>
<td>210464.0</td>
<td>255000.0</td>
<td>1.21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>51428.0</td>
<td>72451.0</td>
<td>123879.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>93200.0</td>
<td>NaN</td>
<td>NaN</td>
<td>422000.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>76125.0</td>
<td>78172.0</td>
<td>275297.0</td>
<td>290000.0</td>
<td>1.14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>154360.0</td>
<td>61934.0</td>
<td>216294.0</td>
<td>237000.0</td>
<td>1.10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>65376.0</td>
<td>NaN</td>
<td>NaN</td>
<td>286500.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>42400.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>40800.0</td>
<td>92606.0</td>
<td>133406.0</td>
<td>168000.0</td>
<td>1.26</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>In addition to empty entries, read.csv() interprets a number of entries as missing (unobserved) values: “#N/A”, “#N/A N/A”, “#NA”, “-1.#IND”, “-1.#QNAN”, “-NaN”, “-nan”, “1.#IND”, “1.#QNAN”, “&lt;NA&gt;”, “N/A”, “NA”, “NULL”, “NaN”, “None”, “n/a”, “nan”, “null “. Despite those, CSV files might have special values to indicate missing values, for example, when they are exported from other software packages. Suppose that the missing values are indicated by a dot (“.”). Also, the columns in the CSV file are formatted with white space:</p>
<pre><code>data&gt; head landsales.csv
land, improve, total, sale, appraisal
30000,     64831,     94831,    118500,   1.25
30000,     50765,     80765,     93900,   1.16
46651,     18573,     65224,         .,    .
45990,     91402,    137392,    184000,   1.34
42394,         .,         .,    168000,    .
    .,    133351,         .,    169000,    .
63596,      2182,     65778,         .,    .
56658,    153806,    210464,    255000,   1.21
51428,     72451,    123879,         .,    .</code></pre>
<p>The file is much more human readable, but requires additional options to convert to the intended DataFrame:</p>
<div id="0d016601" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>land2 <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/landsales.csv"</span>, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                   na_values<span class="op">=</span><span class="st">"."</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                   skipinitialspace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>land2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">land</th>
<th data-quarto-table-cell-role="th">improve</th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">sale</th>
<th data-quarto-table-cell-role="th">appraisal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>30000.0</td>
<td>64831.0</td>
<td>94831.0</td>
<td>118500.0</td>
<td>1.25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>30000.0</td>
<td>50765.0</td>
<td>80765.0</td>
<td>93900.0</td>
<td>1.16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>46651.0</td>
<td>18573.0</td>
<td>65224.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>45990.0</td>
<td>91402.0</td>
<td>137392.0</td>
<td>184000.0</td>
<td>1.34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>42394.0</td>
<td>NaN</td>
<td>NaN</td>
<td>168000.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The <code>na.values=</code> option specifies additional values that should be recognized as missing values. The <code>skipinitalspace=</code> option tells<code>read_csv()</code> to ignore spaces following the delimiters. The result is as intended.</p>
</section>
<section id="json-files" class="level3">
<h3 class="anchored" data-anchor-id="json-files">JSON files</h3>
<p>Pandas has great support for reading and writing JSON files. A general issue is that JSON is a hierarchical data format that allows nested data structures whereas pandas DataFrames have a row—column layout. Fortunately, the pandas<a href="https://pandas.pydata.org/docs/reference/api/pandas.read_json.html"><code>read_json()</code></a> method has many options to shape nested JSON structures into DataFrames.</p>
<p>You can convert any JSON document into a Python dictionary with the load() function in the json library. Suppose we want to read this document, stored in <code>../datasets/JSON/simple1.json</code> into Python:</p>
<pre><code>&gt; cat ../datasets/JSON/simple1.json
{
    "firstName": "Jane",
    "lastName": "Doe",
    "hobbies": ["running", "sky diving", "singing"],
    "age": 35,
    "children": [
        {
            "firstName": "Alice",
            "age": 6
        },
        {
            "firstName": "Bob",
            "age": 8
        }
    ]
}</code></pre>
<div id="1fac52c8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../datasets/JSON/simple1.json"</span>,<span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> json.load(f)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>{'firstName': 'Jane',
 'lastName': 'Doe',
 'hobbies': ['running', 'sky diving', 'singing'],
 'age': 35,
 'children': [{'firstName': 'Alice', 'age': 6},
  {'firstName': 'Bob', 'age': 8}]}</code></pre>
</div>
</div>
<p>The next example reads a record-oriented JSON file (<code>../datasets/JSON/simple.json</code>) directly into a DataFrame. Each record consists of fields <code>id</code>, <code>name</code>, <code>math</code>, <code>statistics</code>, and <code>weight</code>.</p>
<pre><code>cat simple.json 
[
  {
    "id": "A00123",
    "name": "David",
    "math": 70,
    "statistics": 86,
    "weight": 156.3
  },
  {
    "id": "B00422",
    "name": "Andrew",
    "math": 89,
    "statistics": 80,
    "weight": 210.6
  },
  {
    "id": "C004543",
    "name": "Tobias",
    "math": 79,
    "statistics": 90,
    "weight": 167.0
  }
]</code></pre>
<div id="a363bb76" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">"../datasets/JSON/simple.json"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3 entries, 0 to 2
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   id          3 non-null      object 
 1   name        3 non-null      object 
 2   math        3 non-null      int64  
 3   statistics  3 non-null      int64  
 4   weight      3 non-null      float64
dtypes: float64(1), int64(2), object(2)
memory usage: 252.0+ bytes</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">math</th>
<th data-quarto-table-cell-role="th">statistics</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A00123</td>
<td>David</td>
<td>70</td>
<td>86</td>
<td>156.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B00422</td>
<td>Andrew</td>
<td>89</td>
<td>80</td>
<td>210.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C004543</td>
<td>Tobias</td>
<td>79</td>
<td>90</td>
<td>167.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>If you’d rather assign data type string to the <code>id</code> and <code>name</code> fields than data type object, you can set the data type with</p>
<div id="03c861ae" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_json(<span class="st">"../datasets/JSON/simple.json"</span>, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                   dtype<span class="op">=</span> {<span class="st">"id"</span>: <span class="st">"string"</span>, <span class="st">"name"</span> : <span class="st">"string"</span>})</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df2.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3 entries, 0 to 2
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   id          3 non-null      string 
 1   name        3 non-null      string 
 2   math        3 non-null      int64  
 3   statistics  3 non-null      int64  
 4   weight      3 non-null      float64
dtypes: float64(1), int64(2), string(2)
memory usage: 252.0 bytes</code></pre>
</div>
</div>
<p>How can we handle a nested JSON structure? The data in <code>../datasets/JSON/nested_array.json</code> is</p>
<pre><code>data&gt; cat nested_array.json
{
    "school_name": "Virginia Tech",
    "class": "Class of 2026",
    "students": [
      {
        "id": "A00123",
        "name": "David",
        "math": 70,
        "statistics": 86,
        "weight": 156.3
      },
      {
        "id": "B00422",
        "name": "Andrew",
        "math": 89,
        "statistics": 80,
        "weight": 210.6
      },
      {
        "id": "C004543",
        "name": "Tobias",
        "math": 79,
        "statistics": 90,
        "weight": 167.0
      }]
}</code></pre>
<p>The <code>students</code> fields have a record structure but there are additional fields <code>school_name</code> and <code>class</code> that do not fit that structure. Converting the JSON file directly into a DataFrame does not produce the desired result:</p>
<div id="0986fb54" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.read_json(<span class="st">'../datasets/JSON/nested_array.json'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">school_name</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">students</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>{'id': 'A00123', 'name': 'David', 'math': 70, ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>{'id': 'B00422', 'name': 'Andrew', 'math': 89,...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>{'id': 'C004543', 'name': 'Tobias', 'math': 79...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>To create the appropriate DataFrame we take two steps: convert the JSON file into a dictionary, then shape the dictionary into a DataFrame with <code>json_normalize()</code>:</p>
<div id="1c368dce" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'../datasets/JSON/nested_array.json'</span>,<span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> json.load(f)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pd.json_normalize(data, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                        record_path <span class="op">=</span>[<span class="st">"students"</span>],</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                        meta<span class="op">=</span>[<span class="st">"school_name"</span>, <span class="st">"class"</span>])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>df4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">math</th>
<th data-quarto-table-cell-role="th">statistics</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">school_name</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A00123</td>
<td>David</td>
<td>70</td>
<td>86</td>
<td>156.3</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B00422</td>
<td>Andrew</td>
<td>89</td>
<td>80</td>
<td>210.6</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C004543</td>
<td>Tobias</td>
<td>79</td>
<td>90</td>
<td>167.0</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The <code>meta=</code> option lists the JSON fields that are used as data that applies to each record in the result table. The <code>record_path=</code> option points at the field that contains the list of records.</p>
<p>Now suppose that in addition to the list of records the JSON metadata contains a more complex structure:</p>
<pre><code>cat nested_obj_array.json
{
   "school_name": "Virginia Tech",
   "class": "Class of 2026",
    "info": {
      "president": "Timothy D. Sands",
      "address": "Office of the President",
      "social": {
        "LinkedIn": "tim-sands-49b8b95",
        "Twitter": "@VTSandsman"
      }
    },
    "students": [
      {
        "id": "A00123",
        "name": "David",
        "math": 70,
        "statistics": 86,
        "weight": 156.3
      },
. . .
      }]
}</code></pre>
<p>You can specify which fields to extract from the metadata in the <code>meta=</code> option of <code>json_normalize()</code>:</p>
<div id="a9e854de" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'../datasets/JSON/nested_obj_array.json'</span>,<span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> json.load(f)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> pd.json_normalize(data,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                       record_path <span class="op">=</span>[<span class="st">"students"</span>], </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                       meta<span class="op">=</span>[<span class="st">"school_name"</span>,<span class="st">"class"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                             [<span class="st">"info"</span>, <span class="st">"president"</span>], </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                             [<span class="st">"info"</span>, <span class="st">"social"</span>, <span class="st">"Twitter"</span>]])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>df5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">math</th>
<th data-quarto-table-cell-role="th">statistics</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">school_name</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">info.president</th>
<th data-quarto-table-cell-role="th">info.social.Twitter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A00123</td>
<td>David</td>
<td>70</td>
<td>86</td>
<td>156.3</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>Timothy D. Sands</td>
<td>@VTSandsman</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B00422</td>
<td>Andrew</td>
<td>89</td>
<td>80</td>
<td>210.6</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>Timothy D. Sands</td>
<td>@VTSandsman</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C004543</td>
<td>Tobias</td>
<td>79</td>
<td>90</td>
<td>167.0</td>
<td>Virginia Tech</td>
<td>Class of 2026</td>
<td>Timothy D. Sands</td>
<td>@VTSandsman</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>How are missing values handled? In the next example, the first has a complete record. The second student misses a statistics score, the third student has no weight data. <code>pd.json_normalize()</code> fills in NaN for the unobserved data.</p>
<div id="31db0fb8" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"students"</span>: [</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"id"</span>: <span class="st">"A00123"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"name"</span>: <span class="st">"David"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"math"</span>: <span class="dv">70</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"statistics"</span>: <span class="dv">86</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"weight"</span>: <span class="fl">156.3</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"id"</span>: <span class="st">"B00422"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"name"</span>: <span class="st">"Andrew"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"math"</span>: <span class="dv">89</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"weight"</span>: <span class="fl">210.6</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>          },</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"id"</span>: <span class="st">"C004543"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"name"</span>: <span class="st">"Tobias"</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"math"</span>: <span class="dv">79</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"statistics"</span>: <span class="dv">90</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>df6 <span class="op">=</span> pd.json_normalize(data, record_path <span class="op">=</span>[<span class="st">"students"</span>])</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>df6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">math</th>
<th data-quarto-table-cell-role="th">statistics</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A00123</td>
<td>David</td>
<td>70</td>
<td>86.0</td>
<td>156.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B00422</td>
<td>Andrew</td>
<td>89</td>
<td>NaN</td>
<td>210.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C004543</td>
<td>Tobias</td>
<td>79</td>
<td>90.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><code>json_normalize()</code> is less forgiving if fields in the metadata are unobserved; it will throw an error. To prevent the error and assign NaN values, use the <code>errors=’ignore’</code> option. In the following example the <code>teachers</code> meta data field does not always have a <code>l_name</code> entry.</p>
<div id="bf040bdf" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'class'</span>: <span class="st">'STAT 5525'</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'student count'</span>: <span class="dv">60</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'room'</span>: <span class="st">'Yellow'</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'teachers'</span>: { </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'f_name'</span>: <span class="st">'Elon'</span>, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'l_name'</span>: <span class="st">'Musk'</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'students'</span>: [</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            { <span class="st">'name'</span>: <span class="st">'Tom'</span>, <span class="st">'sex'</span>: <span class="st">'M'</span> },</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>            { <span class="st">'name'</span>: <span class="st">'James'</span>, <span class="st">'sex'</span>: <span class="st">'M'</span> },</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    { </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'class'</span>: <span class="st">'STAT 5526'</span>, </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'student count'</span>: <span class="dv">45</span>, </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'room'</span>: <span class="st">'Blue'</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">'teachers'</span>: { </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">'f_name'</span>: <span class="st">'Albert'</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'students'</span>: [</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>            { <span class="st">'name'</span>: <span class="st">'Tony'</span>, <span class="st">'sex'</span>: <span class="st">'M'</span> },</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>            { <span class="st">'name'</span>: <span class="st">'Jacqueline'</span>, <span class="st">'sex'</span>: <span class="st">'F'</span> },</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>df7 <span class="op">=</span> pd.json_normalize(data, </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                        record_path <span class="op">=</span>[<span class="st">"students"</span>], </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>                        meta<span class="op">=</span>[<span class="st">"class"</span>, <span class="st">"room"</span>, [<span class="st">"teachers"</span>, <span class="st">"l_name"</span>]],</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                        errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>df7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">room</th>
<th data-quarto-table-cell-role="th">teachers.l_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Tom</td>
<td>M</td>
<td>STAT 5525</td>
<td>Yellow</td>
<td>Musk</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>James</td>
<td>M</td>
<td>STAT 5525</td>
<td>Yellow</td>
<td>Musk</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Tony</td>
<td>M</td>
<td>STAT 5526</td>
<td>Blue</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Jacqueline</td>
<td>F</td>
<td>STAT 5526</td>
<td>Blue</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="parquet-files" class="level3">
<h3 class="anchored" data-anchor-id="parquet-files">Parquet files</h3>
<p>To read parquet files into pandas DataFrames we have two choices: the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_parquet.html">read_parquet()</a> pandas method or the <code>read_table()</code> method from pyarrow.parquet.</p>
<p>The data we work with in this section is stored in a parquet multi-file structure; that means the data are split into multiple files stored in a local directory:</p>
<pre><code>Parquet ll userdata
total 1120
-rw-r--r--@ 1 olivers  staff   111K Aug 31 14:36 userdata1.parquet
-rw-r--r--@ 1 olivers  staff   110K Aug 31 14:36 userdata2.parquet
-rw-r--r--@ 1 olivers  staff   111K Aug 31 14:37 userdata3.parquet
-rw-r--r--@ 1 olivers  staff   110K Aug 31 14:37 userdata4.parquet
-rw-r--r--@ 1 olivers  staff   111K Aug 31 14:37 userdata5.parquet</code></pre>
<p>Each of the *.parquet files in the directory contains 1,000 observations.</p>
<p>Pandas’ <code>read_parquet()</code> reads the entire directory and combines the records from the multiple files into a single DataFrame.</p>
<div id="6a3db614" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_parquet(<span class="st">"../datasets/Parquet/userdata"</span>, engine<span class="op">=</span><span class="st">"pyarrow"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 5000 entries, 0 to 4999
Data columns (total 13 columns):
 #   Column             Non-Null Count  Dtype         
---  ------             --------------  -----         
 0   registration_dttm  5000 non-null   datetime64[ns]
 1   id                 4999 non-null   float64       
 2   first_name         5000 non-null   object        
 3   last_name          5000 non-null   object        
 4   email              5000 non-null   object        
 5   gender             5000 non-null   object        
 6   ip_address         5000 non-null   object        
 7   cc                 5000 non-null   object        
 8   country            5000 non-null   object        
 9   birthdate          5000 non-null   object        
 10  salary             4689 non-null   float64       
 11  title              5000 non-null   object        
 12  comments           4966 non-null   object        
dtypes: datetime64[ns](1), float64(2), object(10)
memory usage: 507.9+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">registration_dttm</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5000</td>
<td>4999.000000</td>
<td>4689.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2016-02-03 21:04:13.699399936</td>
<td>500.598720</td>
<td>150772.222890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2016-02-03 00:00:07</td>
<td>1.000000</td>
<td>12068.960000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2016-02-03 08:51:55.750000128</td>
<td>251.000000</td>
<td>83480.380000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2016-02-03 20:01:17</td>
<td>501.000000</td>
<td>152877.190000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2016-02-04 07:42:54.500000</td>
<td>750.500000</td>
<td>215405.220000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2016-02-04 23:59:55</td>
<td>1000.000000</td>
<td>286735.820000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>288.648331</td>
<td>78171.513062</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The size of <code>df</code> confirms that all 5,000 observations were retrieved from the five component files.</p>
<p>With pyarrow we have more control over the files, for example, we can inquire about the schema and metadata of the component files.</p>
<div id="01b2513d" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow.parquet <span class="im">as</span> pq</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>pq_file <span class="op">=</span> pq.ParquetFile(<span class="st">"../datasets/Parquet/userdata/userdata1.parquet"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>pq_file.metadata</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>pq_file.schema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;pyarrow._parquet.ParquetSchema object at 0x15043ea40&gt;
required group field_id=-1 hive_schema {
  optional int96 field_id=-1 registration_dttm;
  optional int32 field_id=-1 id;
  optional binary field_id=-1 first_name (String);
  optional binary field_id=-1 last_name (String);
  optional binary field_id=-1 email (String);
  optional binary field_id=-1 gender (String);
  optional binary field_id=-1 ip_address (String);
  optional binary field_id=-1 cc (String);
  optional binary field_id=-1 country (String);
  optional binary field_id=-1 birthdate (String);
  optional double field_id=-1 salary;
  optional binary field_id=-1 title (String);
  optional binary field_id=-1 comments (String);
}</code></pre>
</div>
</div>
<p>To convert all component files into a pandas DataFrame with pyarrow, use the <code>read_table()</code> method and send the result <code>to_pandas()</code>:</p>
<div id="c3753773" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pq.read_table(source<span class="op">=</span><span class="st">"../datasets/Parquet/userdata/"</span>).to_pandas()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df2.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">registration_dttm</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5000</td>
<td>4999.000000</td>
<td>4689.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2016-02-03 21:04:13.699399936</td>
<td>500.598720</td>
<td>150772.222890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2016-02-03 00:00:07</td>
<td>1.000000</td>
<td>12068.960000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2016-02-03 08:51:55.750000128</td>
<td>251.000000</td>
<td>83480.380000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2016-02-03 20:01:17</td>
<td>501.000000</td>
<td>152877.190000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2016-02-04 07:42:54.500000</td>
<td>750.500000</td>
<td>215405.220000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2016-02-04 23:59:55</td>
<td>1000.000000</td>
<td>286735.820000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>288.648331</td>
<td>78171.513062</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="orc-files" class="level3">
<h3 class="anchored" data-anchor-id="orc-files">ORC files</h3>
<p>Pandas (and pyarrow) supports ORC files but working with ORC files is not quite as convenient as with parquet files. The <code>read_orc()</code> method reads one ORC file rather than an entire directory and it is not supported on Windows.</p>
<div id="3c101df9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_orc(<span class="st">"../datasets/ORC/userdata/userdata1.orc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When data is stored in multi-file format, as in the parquet example, you need to concatenate the contents into a pandas DataFrame. The glob module is helpful to retrieve the list of file names that match a pattern.</p>
<div id="893ca487" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">"../datasets/ORC/userdata"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>file_list <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">"/*.orc"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>df_from_orc <span class="op">=</span> pd.DataFrame(pd.read_orc(file_list[<span class="dv">0</span>]))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(file_list)):</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.read_orc(file_list[i])</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    df_from_orc <span class="op">=</span> pd.concat([df_from_orc,df],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also use the <code>read_table()</code> method for ORC files in pyarrow to read ORC an file into a pyarrow table and <code>to_pandas()</code> to convert the table to a pandas DataFrame:</p>
<div id="f0778be0" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyarrow <span class="im">import</span> orc</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> orc.read_table(source<span class="op">=</span><span class="st">"../datasets/ORC/userdata/userdata1.orc"</span>).to_pandas()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="working-with-a-database" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="working-with-a-database"><span class="header-section-number">5.2</span> Working with a Database</h2>
<p>As a data scientist you need to be comfortable working with databases. In analytical work, you will encounter schema-centric relational OLAP databases that use SQL (structured query language) to interact with the database and the data. SQL interfaces are standard for data warehouses and common for many data platforms and tools.</p>
<p>Data scientists generally prefer writing Python or R code over SQL. SQL is extremely powerful to express relational concepts and can make some data processing tasks much easier than rolling your own code. Also, databases are optimized for joins, merges, deep queries, aggregations, indexes, handling JSON, etc. It would be a shame not to take advantage of that power or to lose it behind the syntactic sugar of a tool’s API. Many employers have voiced concerns that SQL ranks high among the technical skills data scientists often lack. As the founder and chairman of a data science research and consultancy company put it:</p>
<blockquote class="blockquote">
<p><em>There are a lot of things folks don’t agree on. But everyone agrees that as a data scientist you will need to retrieve data from a database, and you will need version control. Learn SQL and learn git.</em></p>
</blockquote>
<p>We are covering SQL basics in <a href="sqlbasics.html" class="quarto-xref"><span>Chapter 9</span></a> after sprinkling some SQL statements along the way.</p>
<p>If you want to work with SQL directly from Python, there are several alternatives.</p>
<section id="sqlalchemy" class="level3">
<h3 class="anchored" data-anchor-id="sqlalchemy">SQLAlchemy</h3>
<p><a href="https://www.sqlalchemy.org/">SQLAlchemy</a> is a SQL toolkit for Python that gives Python developers the power of SQL. While some tools try to hide SQL and relational details behind syntactic sugar, SQLAlchemy’s philosophy is to fully expose the relational details of SQL within transparent tools. Specific databases, beyond those for which support is built into SQLAlchemy, are supported as <a href="https://docs.sqlalchemy.org/en/20/dialects/index.html">dialects</a>.</p>
</section>
<section id="ibis" class="level3">
<h3 class="anchored" data-anchor-id="ibis">Ibis</h3>
<p><a href="https://ibis-project.org/">Ibis</a> is a portable Python dataframe library that supports multiple database backends. After making a connection to a backend database, you interact with the data using Python syntax rather than SQL statements. The Ibis function calls are translated into SQL for the specific backend under the covers. For example, the first statement in the next code block creates a Python object named <code>penguins</code> through which you can interact with the database table of the same name. The second statement filters the data for a specific species.</p>
<pre class="{default}"><code>penguins = con.table("penguins")
penguins.filter(penguins.species == "Adelie")</code></pre>
<p>The SQL equivalent would be a SELECT statement with a WHERE clause:</p>
<pre class="{default}"><code>SELECT * FROM penguins WHERE species = “Adelie”</code></pre>
<p>Having stable Python code for different database backends makes it easy to move from one database to another. During development of analytic code you might be working with SQLite and the production database is Oracle. The same Python code will work in both environments.</p>
<p>The default backend of Ibis is the embedded database <a href="https://duckdb.org/">DuckDB</a>. If you are working with DuckDB you can issue SQL statements directly from Python or you can rely on its dedicated Python API.</p>
</section>
<section id="duckdb" class="level3">
<h3 class="anchored" data-anchor-id="duckdb">DuckDB</h3>
<p>DuckDB has all the ingredients we are looking for in a database for data science work:</p>
<ul>
<li><p>Designed to support analytical queries (OLAP workloads) characterized by complex queries that process large amounts of data.</p></li>
<li><p>Columnar, vectorized storage engine. Columnar storage is more efficient for analytical queries, vectorized queries execute much faster than systems that process rows sequentially.</p></li>
<li><p>Provides transactional guarantees (ACID properties)</p></li>
<li><p>Deeply integrated with Python or R for efficient data analysis.</p></li>
<li><p>Easy to install and operate, without any external dependencies.</p></li>
<li><p>Open-source database that is free to use.</p></li>
<li><p>Can query CSV, JSON, Parquet files and DataFrames directly.</p></li>
<li><p>Supports a streaming model for analyzing large data sets that exceed memory capacity, e.g., streaming from Parquet files.</p></li>
<li><p>In-memory database with graceful on-disk operation.</p></li>
<li><p>Easy transition to the cloud through partnership with MotherDuck.</p></li>
<li><p>SQL code can be submitted from the CLI or through the Python API, so you can take advantage of the power of SQL.</p></li>
<li><p>Runs as an embedded database within a host process.</p></li>
</ul>
<p>Because DuckDB is an embedded database, there is no database server to install and to maintain. Because the database runs within the host process, data can be transferred very quickly. And if you want to move the data to the cloud, you can do that easily with the <a href="https://motherduck.com/">MotherDuck</a> serverless platform.</p>
<p>The Python package for DuckDB can run queries directly from Pandas DataFrame without copying any data.</p>
<p>Why is it called DuckDB? We let the folks who created it <a href="https://duckdb.org/faq#why-call-it-duckdb">explain it</a>:</p>
<blockquote class="blockquote">
<p><em>Ducks are amazing animals. They can fly, walk and swim. They can also live off pretty much everything. They are quite resilient to environmental challenges. A duck’s song will bring people back from the dead and inspires database research. They are thus the perfect mascot for a versatile and resilient data management system. Also the logo designs itself.</em></p>
</blockquote>
<p>For the Python user, installation is as simple as with any other Python package:</p>
<pre><code>pip install duckdb</code></pre>
<p>If you install with conda, the command is</p>
<pre><code>conda install python-duckdb -c conda-forge</code></pre>
<p>DuckDB is an in-memory database. If you want to persist the database across Python sessions, then you need to create a connection that stores the data in a single file on disk. Otherwise, the database will go away when the Python session ends. You can work without a connection to a database by using methods on the duckdb module. For example, the following statements directly query a CSV file using DuckDB:</p>
<div id="9ebf96f0" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">'select * from "../datasets/fitness.csv" where Age &gt; 50'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>┌───────┬────────┬────────┬─────────┬───────────┬──────────┬──────────┐
│  Age  │ Weight │ Oxygen │ RunTime │ RestPulse │ RunPulse │ MaxPulse │
│ int64 │ double │ double │ double  │   int64   │  int64   │  int64   │
├───────┼────────┼────────┼─────────┼───────────┼──────────┼──────────┤
│    54 │  83.12 │ 51.855 │   10.33 │        50 │      166 │      170 │
│    51 │  69.63 │ 40.836 │   10.95 │        57 │      168 │      172 │
│    51 │  77.91 │ 46.672 │    10.0 │        48 │      162 │      168 │
│    57 │  73.37 │ 39.407 │   12.63 │        58 │      174 │      176 │
│    54 │  79.38 │  46.08 │   11.17 │        62 │      156 │      165 │
│    52 │  76.32 │ 45.441 │    9.63 │        48 │      164 │      166 │
│    51 │  67.25 │ 45.118 │   11.08 │        48 │      172 │      172 │
│    54 │  91.63 │ 39.203 │   12.88 │        44 │      168 │      172 │
│    51 │  73.71 │  45.79 │   10.47 │        59 │      186 │      188 │
│    57 │  59.08 │ 50.545 │    9.93 │        49 │      148 │      155 │
│    52 │  82.78 │ 47.467 │    10.5 │        53 │      170 │      172 │
├───────┴────────┴────────┴─────────┴───────────┴──────────┴──────────┤
│ 11 rows                                                   7 columns │
└─────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
</div>
<p>The object returned by duckdb is a <strong>relation</strong>, a symbolic representation of the query that can be referenced in other queries. The next statements save the result of the previous query and reference the relation in the second query:</p>
<div id="03ca4b47" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rel <span class="op">=</span> duckdb.sql(<span class="st">'select * from "../datasets/fitness.csv" where Age &gt; 50'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">"select Oxygen, RunTime, RestPulse from rel where RestPulse &lt; 49"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>┌────────┬─────────┬───────────┐
│ Oxygen │ RunTime │ RestPulse │
│ double │ double  │   int64   │
├────────┼─────────┼───────────┤
│ 46.672 │    10.0 │        48 │
│ 45.441 │    9.63 │        48 │
│ 45.118 │   11.08 │        48 │
│ 39.203 │   12.88 │        44 │
└────────┴─────────┴───────────┘</code></pre>
</div>
</div>
<p>The results of a DuckDB query can be easily converted into other formats. <code>fetchnumpy()</code> fetches data as a dictionary of NumPy arrays, <code>df()</code> fetches a Pandas DataFrame, <code>pl()</code> fetches a Polars DataFrame, and <code>arrow()</code> fetches an Arrow table.</p>
<div id="12e8e67d" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>duckdb.sql(<span class="st">"select Oxygen, RunTime, RestPulse from rel where RestPulse &lt; 49"</span>).df()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Oxygen</th>
<th data-quarto-table-cell-role="th">RunTime</th>
<th data-quarto-table-cell-role="th">RestPulse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>46.672</td>
<td>10.00</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>45.441</td>
<td>9.63</td>
<td>48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>45.118</td>
<td>11.08</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>39.203</td>
<td>12.88</td>
<td>44</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<section id="reading-files" class="level4">
<h4 class="anchored" data-anchor-id="reading-files">Reading files</h4>
<p>To read the major data science file formats into DuckDB, use the <code>read_csv()</code>, <code>read_parquet()</code>, <code>read_json()</code>, and <code>read_arrow()</code> methods. For example, to read the simple JSON file from the previous section:</p>
<div id="6e4a7277" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>duckdb.read_json(<span class="st">'../datasets/JSON/simple.json'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>┌─────────┬─────────┬───────┬────────────┬────────┐
│   id    │  name   │ math  │ statistics │ weight │
│ varchar │ varchar │ int64 │   int64    │ double │
├─────────┼─────────┼───────┼────────────┼────────┤
│ A00123  │ David   │    70 │         86 │  156.3 │
│ B00422  │ Andrew  │    89 │         80 │  210.6 │
│ C004543 │ Tobias  │    79 │         90 │  167.0 │
└─────────┴─────────┴───────┴────────────┴────────┘</code></pre>
</div>
</div>
<p>To read a directory of Parquet files, you can use wildcard syntax in the path of the <code>read_parquet()</code> function:</p>
<div id="9ccc0526" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>duckdb.read_parquet(<span class="st">'../datasets/Parquet/userdata/user*.parquet'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>┌─────────────────────┬───────┬────────────┬───┬────────────┬───────────┬──────────────────────┬──────────────────────┐
│  registration_dttm  │  id   │ first_name │ … │ birthdate  │  salary   │        title         │       comments       │
│      timestamp      │ int32 │  varchar   │   │  varchar   │  double   │       varchar        │       varchar        │
├─────────────────────┼───────┼────────────┼───┼────────────┼───────────┼──────────────────────┼──────────────────────┤
│ 2016-02-03 16:07:46 │     1 │ Ernest     │ … │            │ 140639.36 │                      │                      │
│ 2016-02-03 21:52:07 │     2 │ Anthony    │ … │ 1/16/1998  │ 172843.61 │ Developer II         │ 👾 🙇 💁 🙅 🙆 🙋 …  │
│ 2016-02-03 02:22:19 │     3 │ Ryan       │ … │ 11/21/1978 │ 204620.66 │ Developer I          │ ␢                    │
│ 2016-02-03 04:20:04 │     4 │ Brenda     │ … │ 10/29/1998 │ 260474.12 │ GIS Technical Arch…  │                      │
│ 2016-02-03 00:15:16 │     5 │ Jacqueline │ … │ 7/12/1959  │ 286038.78 │ Marketing Assistant  │                      │
│ 2016-02-03 19:48:14 │     6 │ Paul       │ … │            │ 241518.24 │                      │                      │
│ 2016-02-03 08:59:05 │     7 │ Linda      │ … │ 3/30/1988  │ 192756.38 │ Professor            │                      │
│ 2016-02-03 08:04:51 │     8 │ Frances    │ … │            │ 188511.28 │                      │ &lt;svg&gt;&lt;script&gt;0&lt;1&gt;a…  │
│ 2016-02-03 08:12:33 │     9 │ Jason      │ … │ 7/29/1982  │ 238068.56 │ Web Designer III     │                      │
│ 2016-02-03 17:08:02 │    10 │ Carolyn    │ … │ 4/28/1977  │ 132718.26 │ Research Nurse       │                      │
│          ·          │     · │  ·         │ · │     ·      │     ·     │       ·              │          ·           │
│          ·          │     · │  ·         │ · │     ·      │     ·     │       ·              │          ·           │
│          ·          │     · │  ·         │ · │     ·      │     ·     │       ·              │          ·           │
│ 2016-02-04 04:48:13 │   991 │ Fred       │ … │ 1/25/1975  │ 280835.07 │ Cost Accountant      │                      │
│ 2016-02-04 00:03:33 │   992 │ Anna       │ … │ 5/29/1962  │ 286181.88 │ Automation Special…  │                      │
│ 2016-02-04 07:05:48 │   993 │ Donna      │ … │ 6/3/1962   │  245704.0 │ Senior Financial A…  │                      │
│ 2016-02-04 21:15:41 │   994 │ Annie      │ … │            │ 194931.47 │                      │                      │
│ 2016-02-04 05:05:12 │   995 │ Carlos     │ … │ 8/11/1986  │  39424.88 │ Teacher              │                      │
│ 2016-02-04 21:45:05 │   996 │ Stephanie  │ … │ 5/9/1962   │  273504.1 │ Chief Design Engin…  │                      │
│ 2016-02-04 09:20:21 │   997 │ Kathy      │ … │ 12/4/1986  │ 109525.48 │ Director of Sales    │                      │
│ 2016-02-04 00:26:05 │   998 │ Louis      │ … │ 11/20/1982 │  13134.47 │ Office Assistant IV  │                      │
│ 2016-02-04 04:50:33 │   999 │ Elizabeth  │ … │ 3/14/1976  │ 207194.65 │ Research Assistant I │                      │
│ 2016-02-04 16:14:42 │  1000 │ Susan      │ … │ 12/19/1999 │ 229961.89 │ Human Resources Ma…  │                      │
├─────────────────────┴───────┴────────────┴───┴────────────┴───────────┴──────────────────────┴──────────────────────┤
│ 5000 rows (20 shown)                                                                           13 columns (7 shown) │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
</div>
</section>
<section id="connecting-to-the-database" class="level4">
<h4 class="anchored" data-anchor-id="connecting-to-the-database">Connecting to the database</h4>
<p>If you make an explicit connection to the database with the <code>connect()</code> method, the arguments determine whether the database resides completely in memory—and is destroyed when the Python process exits—or whether the database persists on disk. The following statements are equivalent and create a non-persistent database:</p>
<pre><code>conn = duckdb.connect(database=":default:")
conn = duckdb.connect(database=":memory:")
conn = duckdb.connect(":memory:")
conn = duckdb.connect()</code></pre>
<p>Once the connection is established you use the same methods on the connection object as on the duckdb object:</p>
<div id="8df77500" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> duckdb.<span class="ex">connect</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"select Oxygen, RunTime, RestPulse from rel where RestPulse &lt; 49"</span>).df()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Oxygen</th>
<th data-quarto-table-cell-role="th">RunTime</th>
<th data-quarto-table-cell-role="th">RestPulse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>46.672</td>
<td>10.00</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>45.441</td>
<td>9.63</td>
<td>48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>45.118</td>
<td>11.08</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>39.203</td>
<td>12.88</td>
<td>44</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>To create or access a persisted database, specify the name of the database using a <code>.db</code>, <code>.ddb</code>, or <code>.duckdb</code> extension. The following statements create or open the database <code>ads5064.db</code>, read a CSV file into a Pandas DataFrame and create the table fitness from the DataFrame in the database.</p>
<pre class="{default}"><code>conn = duckdb.connect(database="ads5064.db")
df = conn.read_csv('../datasets/fitness.csv').df()
conn.execute('CREATE TABLE fitness AS SELECT * FROM df')
</code></pre>
<p>You can see all the tables in a database by querying the information schema:</p>
<div id="7f9ec7d9" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">'select * from information_schema.tables'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>┌───────────────┬──────────────┬────────────┬────────────┬───┬────────────────────┬──────────┬───────────────┐
│ table_catalog │ table_schema │ table_name │ table_type │ … │ is_insertable_into │ is_typed │ commit_action │
│    varchar    │   varchar    │  varchar   │  varchar   │   │      varchar       │ varchar  │    varchar    │
├────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                   0 rows                                                   │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre>
</div>
</div>
<p>Or with</p>
<div id="4582b7a2" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"show tables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>┌─────────┐
│  name   │
│ varchar │
├─────────┤
│ 0 rows  │
└─────────┘</code></pre>
</div>
</div>
<p>And you can see the available databases with</p>
<div id="127c66b9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"show databases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>┌───────────────┐
│ database_name │
│    varchar    │
├───────────────┤
│ memory        │
└───────────────┘</code></pre>
</div>
</div>
<p>You could have created the table in the database from the CSV file in a single step:</p>
<pre class="{default}"><code>conn = duckdb.connect(database="ads5064.db")
conn.execute('CREATE TABLE fitness AS SELECT * FROM “../data/fitness.csv” ')
</code></pre>
<p>Notice the use of single and double quotes to distinguish the string for the file name inside the SQL statement.</p>
</section>
</section>
</section>
<section id="cloud-data-resources" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="cloud-data-resources"><span class="header-section-number">5.3</span> Cloud Data Resources</h2>
<p>Cloud resources are increasingly important for data storage and analytics. The growth trends in the cloud are staggering. Storing data in cloud file, block, or object storage is a $78.6 billion market with a compound annual growth rate (CAGR) of 18.5% (2022 numbers). Cloud databases in 2023 are a $21.3 billion market that grows at 22%.</p>
<p>You will encounter cloud-based data in your data science work, and you will take advantage of cloud resources, especially for handling and analyzing large data sets.</p>
<p>The most important cloud storage solutions for data are</p>
<ul>
<li><p>Object storage</p></li>
<li><p>Cloud databases</p></li>
<li><p>Cloud data warehouses (Snowflake, BigQuery)</p></li>
<li><p>Cloud lakehouse (Databricks)</p></li>
</ul>
<section id="object-storage" class="level3">
<h3 class="anchored" data-anchor-id="object-storage">Object storage</h3>
<p>Object, file, and block storage work differently. In object storage, data is managed as generic objects. These can be files or parts of files and combine the data to be stored with metadata about the object being stored. Metadata could be, for example, a unique identifier, size, creation date, time, and location for an image. Objects are stored in a flat structure; the object’s identifier is used to locate it in the storage system. Amazon Web Services (AWS) calls the container objects are stored in a <strong>bucket</strong> (rather than a directory).</p>
<p>File storage is what you are used to from a directory-based file system on your computer’s operating system. Data is stored in files, organized in hierarchical folders. You look up data by traversing the directory until you have located the file with the correct name.</p>
<p>Block storage breaks data into fixed-sized blocks and stores the blocks as units. The Hadoop Distributed File System (HDFS) is a block-oriented storage system, where data is split into 16 MB blocks and the blocks are replicated on multiple machines in a distributed system for durability and high availability.</p>
<p>Cloud object storage has nearly replaced other Big Data storage solutions such as Hadoop and HDFS. You can still find Hadoop environments in organizations—lots of money was invested in building those and organizations are slow to migrate off Hadoop. But the writing is on the wall: HDFS is replaced with cloud storage because it is cheaper and more durable, in particular cloud object storage. Since object storage supports storing files as objects, is the most economical storing alternative, and can scale out without limits, it is the primary storage form for fie-based data in the cloud. Even cloud data warehouses have been built with cloud object storage as the primary storage layer.</p>
<p>The object storage systems of the three major cloud providers are</p>
<p><a href="https://aws.amazon.com/s3/">Amazon S3</a> (Simple Storage Service) from AWS, <a href="https://azure.microsoft.com/en-us/products/storage/blobs">Azure Blob Storage</a>, and <a href="https://cloud.google.com/storage">Google Cloud Storage</a>. Common file formats for you find in these storage systems are CSV, JSON, and Parquet.</p>
</section>
<section id="managed-cloud-database" class="level3">
<h3 class="anchored" data-anchor-id="managed-cloud-database">Managed cloud database</h3>
<p><strong>TODO</strong></p>
</section>
<section id="motherduck-serverless-cloud-database" class="level3">
<h3 class="anchored" data-anchor-id="motherduck-serverless-cloud-database">MotherDuck serverless cloud database</h3>
<p>The convenience of a serverless database is not having to worry about the cloud instances the database is running on. With a local, on-premises database, you manage the storage and compute infrastructure—the machines—the database is running on. With a managed service (DBaaS), this aspect is taken care of by the managed service provider. However, you still must manage your database instances. For example, during periods of low usage, you might want to scale down the database or even shut it down to reduce cloud expenses.</p>
<div class="example">
<div class="example-header">
<p>Example: Please turn off your instances</p>
</div>
<div class="example-container">
<p>A common mistake by cloud newbies is to assume that just because you are not actively using the cloud, you are not incurring expenses. When you start an instance in the cloud you need to stop it when it is not in use. Otherwise, it keeps running. Even if there is no workload on the instance, it will cost you money.</p>
<p>A class at a major university—which shall not be named—used cloud resources and the instructors forgot to tell students to shut down their cloud instances. Instead, the students started new instances every time they needed to do cloud computing. The academic unit conducting the class had allocated a $40,000 cloud computing budget over the next three years. The class spent $140,000 in one month.</p>
</div>
</div>
<p>A serverless system automatically scales to zero when not in use for a while. With serverless systems you tend to pay only for what you use, when you use it. An exception are charges for storing data, you cannot turn the storage off. The MotherDuck serverless database is a great complement to the DuckDB analytic database. In fact, MotherDuck is built on DuckDB and you can think of it as the cloud version of DuckDB. That makes MotherDuck a good choice for analytical workloads since DuckDB is a relational column-store, an analytic database.</p>
<p>Another nice feature of MotherDuck is the ability to connect to local databases and to cloud databases at the same time. This hybrid mode is useful if you have large data sets in cloud storage and small-to-large data sets stored locally. Since we already know how to work with DuckDB from Python, working with MotherDuck is a snap. The following statements create a connection to a MotherDuck serverless database:</p>
<pre class="{default}"><code>import duckdb
con = duckdb.connect('md:')
</code></pre>
<p>Notice that we use the same duckdb library as previously. The special string <code>‘md:’</code> or <code>‘motherduck:’</code> inside the <code>connect()</code> function triggers a connection attempt to MotherDuck. Whether the connection attempt succeeds depends on whether you can authenticate to MotherDuck. By default, the <code>connect()</code> function will open a browser through which you can authenticate to the MotherDuck service using a previously established account.</p>
<p>Alternatively, you can click on Settings in the UI of the MotherDuck console at <a href="https://app.motherduck.com/" class="uri">https://app.motherduck.com/</a> and download your authentication token. Store this token in the environment variable motherduck_token on your system and you can authenticate and connect directly to MotherDuck with the previous <code>duckdb.connect()</code> statement. It is also possible to list the authentication token directly in the <code>duckdb.connect()</code> function,</p>
<pre class="{default}"><code>con = duckdb.connect('md:?motherduck_token=&lt;token&gt;')</code></pre>
<p>but this is discouraged. Access credentials should not be shown in clear text in a source file that can easily be read and that might be shared with others. That is a security nightmare waiting to happen.</p>
<p>DuckDB and MotherDuck are relational database management systems, they manage more than one database. You can see the list of databases with the SHOW DATABASES command:</p>
<pre class="{default}"><code>con.sql("SHOW DATABASES")</code></pre>
<p>By default, MotherDuck creates a database called <code>my_db</code> and a shared database with sample data. One of the cool features of MotherDuck is the ability to attach local databases to the instance. The following statement attaches a local version of the database for this course to MotherDuck.</p>
<pre class="{default}"><code>con.sql("ATTACH 'ads5064.ddb'")
con.sql("SHOW DATABASES")
</code></pre>
<p>Since MotherDuck manages multiple databases you have to tell it which database to work with. This is called the current database, by default this is <code>my_db</code> when you first connect. You can see which database is current with</p>
<pre class="{default}"><code>con.sql("SELECT current_database()").show()</code></pre>
<p>You can set any database as the current one with the USE statement:</p>
<pre class="{default}"><code>con.sql("USE ads5064")
con.sql("SHOW TABLES")
</code></pre>
<p>You can access a table in a database that is not the current database by using a two-level name (database.table). This even works if one table is local and the other is in a cloud database. Suppose that ads5064 is a local version of the database for the course and that <code>ads5064_md</code> is stored in the cloud.</p>
<pre class="{default}"><code>con.sql("SELECT count(*) FROM ads5064.apples")
con.sql("SELECT count(*) FROM ads5064_md.glaucoma")
</code></pre>
<p>This comes in very handy if you want to process local and cloud data in the same query, for example when joining tables.</p>
<p>MotherDuck also supports shared read-only databases, to which you connect through a URL. The URL is created by an administrator of the database with the CREATE SHARE command. You can then attach the database by using the URL:</p>
<pre class="{default}"><code>con.sql("ATTACH 'md:_share/ads5064_md/e00063c9-568c-45ec-a372-dca85f6915fd' as course_db")</code></pre>
<p>The URL is a link to a point-in-time snapshot of the database when it was shared. The administrator can update the share of the database, the link will remain valid.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../data/sources_and_files.html" class="pagination-link" aria-label="Data Sources and File Formats">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Sources and File Formats</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../data/quality.html" class="pagination-link" aria-label="Data Quality">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Quality</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Foundations of Data Science by Oliver Schabenberger</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>